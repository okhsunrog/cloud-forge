---
vpn_subnets: # CIDR notation, these subnets will be added to iptables rules (masquerade)
  ocserv_personal: "10.67.76.0/24"
  ocserv_friends: "10.68.68.0/24"
  wireguard: "10.66.66.0/24"

# Network ports configuration, used by all playbooks
ports:
  external: # used by iptables
    ssh: 
      port: 22
      type: tcp
    https:
      port: 443
      type: tcp
    wireguard:
      port: 51820
      type: udp
    http:
      port: 80
      type: tcp
    ocserv_personal:
      port: 443
      type: udp

  internal: # localhost, tcp ports
    ocserv_personal: 447
    ocserv_friends: 448
    nginx_https: 8443

reverse_proxy: # used by nginx
  nas_ip: '10.66.66.2'
  ports:
    jellyfin: 8096
    nextcloud: 2345
    photoprism: 2342
    forgejo: 3000
    snake: 8081
    snake_webrtc: 8082


email: "me@okhsunrog.dev" # for certbot

domains:
  ocserv_personal: "open.okhsunrog.dev"
  ocserv_friends: "kafe.okhsunrog.dev"
  nginx:
    blog:
      - "okhsunrog.ru"
      - "okhsunrog.dev"
    jellyfin:
      - "jellyfin.okhsunrog.ru"
      - "jellyfin.okhsunrog.dev"
    cloud:
      - "cloud.okhsunrog.ru"
      - "cloud.okhsunrog.dev"
    photoprism:
      - "photoprism.okhsunrog.ru"
      - "photoprism.okhsunrog.dev"
    git:
      - "git.okhsunrog.dev"
    # snake:
    #   - "serpentina.okhsunrog.ru"
    #   - "snake.okhsunrog.dev"



ocserv_instances:
  - instance_id: "personal"
    domain: "{{ domains['ocserv_' + instance_id] }}"
    ipv4_network: "{{ vpn_subnets['ocserv_' + instance_id] }}"
    udp_enabled: true
    tcp_port: "{{ ports.internal['ocserv_' + instance_id] }}"
    udp_port: "{{ ports.external['ocserv_' + instance_id].port }}"
    device: "vpn0"
    camouflage_secret: "p3rs0n4l_4cc3ss_0nly"
    camouflage_realm: "Nginx Admin Portal"

  - instance_id: "friends"
    domain: "{{ domains['ocserv_' + instance_id] }}"
    ipv4_network: "{{ vpn_subnets['ocserv_' + instance_id] }}"
    tcp_port: "{{ ports.internal['ocserv_' + instance_id] }}"
    device: "vpn1"
    max_same_clients: 3
    bandwidth: 65536000  # ~65MB/s
    camouflage_secret: "fr13nds_c4f3_p0rt4l"
    camouflage_realm: "Apache Admin Portal"
